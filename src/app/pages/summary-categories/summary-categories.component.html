<ct-navigation-bar></ct-navigation-bar>
<div class="d-flex flex-row">
  <ct-sidebar></ct-sidebar>
  <div class="wrapper">
    <h1>Categories Summary</h1>
    <div class="summary-categories" *ngFor="let categoryGroup of groupedCategories; let index = index">
      <div class="d-flex justify-content-between section-title">
        <p><b>{{categoryGroup.taxpayer}}</b></p>
      </div>
      <p><b>Personal Income Tax Year in Dispute</b></p>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Category Name</th>
            <th>Taxable Income</th>
            <th>Non-refundable Federal Tax Credits</th>
            <th>Non-refundable Provincial Tax Credits</th>
            <th>Other Amounts Payable</th>
            <th>Credits Applied on Filing</th>
            <th>Income Subject to GNP</th>
            <th>Other Penalties</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let category of categoryGroup">
            <td>{{category.name}}</td>
            <td>{{category.taxable_income | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td>{{category.federal_non_refundable_tax_credits | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td>{{category.provincial_non_refundable_tax_credits | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td>{{category.other_amounts_payable | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td>{{category.credits_applied_on_filing | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td>{{category.income_subject_to_gnp | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td>{{category.other_penalties | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
          </tr>
          <tr>
            <td class="total-section">Total</td>
            <td class="total-section">{{categoryGroup.taxable_income_total | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td class="total-section">{{categoryGroup.non_refundable_federal_tax_credits_total | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td class="total-section">{{categoryGroup.non_refundable_provincial_tax_credits_total | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td class="total-section">{{categoryGroup.other_amounts_payable_total | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td class="total-section">{{categoryGroup.credits_applied_on_filing_total | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td class="total-section">{{categoryGroup.income_subject_to_gnp_total | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td class="total-section">{{categoryGroup.other_penalties_total | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="edit-categories">
      <div class="d-flex justify-content-between section-title">
        <p><b>All taxpayers</b></p>
      </div>
      <p><b>Combined</b></p>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Category Name</th>
            <th>Taxable Income Sales</th>
            <th>Non-refundable Federal Tax Credits</th>
            <th>Non-refundable Provincial Tax Credits</th>
            <th>Other Amounts Payable</th>
            <th>Credits Applied on Filing</th>
            <th>Income Subject to GNP</th>
            <th>Other Penalties</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let category of combinedCategories">
            <td>{{category.name}}</td>
            <td>{{category.taxable_income_grouped || category.taxable_income | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td>{{category.federal_non_refundable_tax_credits_grouped || category.federal_non_refundable_tax_credits | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td>{{category.provincial_non_refundable_tax_credits_grouped || category.provincial_non_refundable_tax_credits | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td>{{category.other_amounts_payable_grouped || category.other_amounts_payable | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td>{{category.credits_applied_on_filing_grouped || category.credits_applied_on_filing | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td>{{category.income_subject_to_gnp_grouped || category.income_subject_to_gnp | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td>{{category.other_penalties_grouped || category.other_penalties | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
          </tr>
          <tr>
            <td class="total-section">Total</td>
            <td class="total-section">{{combinedCategoriesTotals.taxable_income_total | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td class="total-section">{{combinedCategoriesTotals.non_refundable_federal_tax_credits_total | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td class="total-section">{{combinedCategoriesTotals.non_refundable_provincial_tax_credits_total | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td class="total-section">{{combinedCategoriesTotals.other_amounts_payable_total | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td class="total-section">{{combinedCategoriesTotals.credits_applied_on_filing_total | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td class="total-section">{{combinedCategoriesTotals.income_subject_to_gnp_total | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
            <td class="total-section">{{combinedCategoriesTotals.other_penalties_total | currency: 'USD': 'symbol-narrow': '1.0-0'}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <button type="button" class="btn btn-primary" (click)='create_csv()'> Create CVS </button>
  </div>
</div>